<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>StarDust: What We’re Made Of</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1aed9710-538a-43d0-a0e2-038550922fce" class="page sans"><header><h1 class="page-title">StarDust: What We’re Made Of</h1><p class="page-description"></p></header><div class="page-body"><blockquote id="5912c269-4a31-4a76-a445-d4a698329e98" class=""><em>Nak Vong, Brandon Wong, Snehaa Ganesh Kumar, Manan Bhargava</em><strong> | </strong><a href="https://github.com/brandogn/N-body"><strong>Source Code</strong></a></blockquote><figure id="6552f85e-6e4f-48b6-adbf-691321e47e24" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled.png"><img style="width:708px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled.png"/></a></figure><h1 id="4f7ab44a-cc62-405f-88df-1cde279840ad" class=""><strong>Abstract</strong></h1><p id="0186c5a2-2d99-4f6b-a320-124ddcab06ed" class="">Supernovae, the explosive endpoints of massive stars, present a challenging phenomenon to model due to their complex multistage dynamics. In this project, we aimed to simulate a supernova explosion from the initial collapse to the final dispersion using an advanced N-body simulation framework. We enhanced the existing simulator by integrating principles of fluid dynamics and Smoothed Particle Hydrodynamics (SPH) techniques, which enabled us to more accurately depict the interactions among particles under extreme conditions. Key implementations included calculations for near density, viscosity, gravity, and pressure, each crucial for simulating the fluid-like behavior of gases under supernova conditions. Additionally, we developed a dynamic temperature map to visualize the variations in thermal energy, offering a vivid and instructive view of the explosive processes. These enhancements allowed us to capture the intricate details of supernova physics, providing a powerful tool for both educational and research purposes in astrophysics.</p><h1 id="697c57e8-6e03-4389-a164-a6db73e684f1" class="">Where we started</h1><figure id="394ffdda-f9e4-4524-a161-b2eb6bd527ed" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled.gif"><img style="width:720px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled.gif"/></a><figcaption>Demo of Original Project</figcaption></figure><ul id="7bac60de-ab5d-4017-87b5-3aa1fb5f7143" class="bulleted-list"><li style="list-style-type:disc">Physics was very simple and only consisted of N-body Newtonian gravitational force calculations (~69 lines)</li></ul><ul id="eb86f2b7-3ada-45f7-bab4-b27e7f586037" class="bulleted-list"><li style="list-style-type:disc">Shaders were calculated using a gradient of colors that is used for interpolation to produce a unique color based on the particle’s velocity, ranging from blue the slowest speed, orange being the middle speed, and yellow being the fastest speed (~55 lines)</li></ul><ul id="a4090501-c90e-416c-b312-35b5f1201ab3" class="bulleted-list"><li style="list-style-type:disc">In total, we ended up modifying ~1458 lines</li></ul><h1 id="10f3c202-5339-409e-879c-ac589ae38633" class="">Technical Approach: Expanding the N-Body Simulation Framework for Supernova Modeling</h1><h3 id="2e2eb74c-0cef-471e-87a5-eacbe6792df8" class="">Detailed Computational Methods in Particle Dynamics</h3><p id="4eab59a7-8d4f-472c-9d62-d04765d4f11f" class="">To simulate the complex interactions within a supernova explosion with high fidelity, our enhancements to the simulation framework focused heavily on advanced fluid dynamics and thermal modeling. We introduced several key methods within the <strong><code>FluidMath.h</code></strong> and <strong><code>ParticleSolverCPUFluid.cpp</code></strong> modules, specifically tailored to capture the essential physics of supernova phenomena.</p><h3 id="a97368a0-d6b4-49c6-b718-9071d8288b8f" class="">Fluid Dynamics Methods</h3><p id="b70e15e9-f080-4779-bc70-8a31a7a02def" class=""><strong>1. Density, Pressure, and Viscosity Calculations:</strong></p><ul id="1f905316-3f05-48f2-ada2-4d6806699820" class="bulleted-list"><li style="list-style-type:disc"><code><strong>densityKernel</strong></code><strong> and </strong><code><strong>densityDerivative</strong></code><strong>:</strong> These functions compute the density of a particle based on its proximity to neighboring particles, utilizing a smoothing kernel approach typical in smoothed-particle hydrodynamics (SPH) simulations. This method ensures that fluid properties like density are smoothed over a set of neighboring particles, providing stability and realism in the simulation of fluid flows.<figure id="2852d628-0273-49da-a61f-9fe9800a0d8f" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>densityKernel</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mn>15</mn><mrow><mn>2</mn><mi>π</mi><msup><mi>h</mi><mn>5</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>r</mi><mo>&lt;</mo><mi>h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{densityKernel}(r,h) = \begin{cases} \frac{15}{2 \pi h^5} (h - r)^2 &amp; \text{{if }} r &lt; h \\0 &amp; \text{{otherwise}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">densityKernel</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">15</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">if </span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">otherwise</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure><figure id="bfbf655f-c2df-4c4d-86eb-df923b0f96f5" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>densityDerivative</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mfrac><mn>15</mn><mrow><mi>π</mi><msup><mi>h</mi><mn>5</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>r</mi><mo>&lt;</mo><mi>h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{densityDerivative}(r,h) = \begin{cases} - \frac{15}{\pi h^5} (h - r) &amp; \text{{if }} r &lt; h \\0 &amp; \text{{otherwise}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">densityDerivative</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">15</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">if </span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">otherwise</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure></li></ul><ul id="4efaa3e5-afaa-4bf1-8276-ba9e99e3a701" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nearDensityKernel</strong></code><strong> and </strong><code><strong>nearDensityDerivative</strong></code><strong>:</strong> Similar to the densityKernel but adjusted to provide higher resolution near critical regions. This enhancement is crucial in regions with sharp gradients such as shock fronts, where accurate density estimations are vital for capturing the correct physics of shock propagation in supernovas.<figure id="ecb546e1-b7af-4f52-b79a-b915478e6b1f" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>nearDensityKernel</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mn>15</mn><mrow><mi>π</mi><msup><mi>h</mi><mn>6</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mi>r</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>r</mi><mo>&lt;</mo><mi>h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{nearDensityKernel}(r,h) = \begin{cases} \frac{15}{\pi h^6} (h - r)^3 &amp; \text{{if }} r &lt; h \\0 &amp; \text{{otherwise}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">nearDensityKernel</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">15</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">if </span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">otherwise</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure><figure id="909f00dc-df00-446f-9cdf-699979fbb1c7" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>nearDensityDerivative</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mfrac><mn>45</mn><mrow><mi>π</mi><msup><mi>h</mi><mn>6</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>r</mi><mo>&lt;</mo><mi>h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{nearDensityDerivative}(r,h) = \begin{cases} -\frac{45}{\pi h^6} (h - r)^2 &amp; \text{{if }} r &lt; h \\0 &amp; \text{{otherwise}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">nearDensityDerivative</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">45</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">if </span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">otherwise</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure><ul id="a6e0ebbb-eb55-4b54-9ce8-cdeb6e245d95" class="bulleted-list"><li style="list-style-type:circle">After computing what was shown above, we calculate the pressure force that is accumulated using the following where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span></span><span>﻿</span></span> is the density (also near density) of the particle, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>n</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>b</mi><mi>o</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\rho_{neighbor}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">hb</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">or</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the density (also near density) of the neighboring particle, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>s</mi><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{shared}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">ha</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the average of the pressure from the particle and the pressure from one of the neighboring particle, both computed using density and near density, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span><span>﻿</span></span> is the velocity vector of the particle:<figure id="63825c52-cf20-431a-8c95-28f216e98e5c" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>pressureForce</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi>ρ</mi><mo separator="true">,</mo><msub><mi>p</mi><mrow><mi>s</mi><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo separator="true">,</mo><msub><mi>ρ</mi><mrow><mi>n</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>b</mi><mi>o</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>ρ</mi><mfrac><mrow><mi mathvariant="bold">v</mi><msub><mi>p</mi><mrow><mi>s</mi><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><msub><mi>ρ</mi><mrow><mi>n</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>b</mi><mi>o</mi><mi>r</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\text{pressureForce}(\mathbf{v}
,\rho
,p_{shared},\rho_{neighbor}
) = \frac{d}{dx} \rho
\frac{\mathbf{v}p_{shared}}{\rho_{neighbor}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord">pressureForce</span></span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ρ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">ha</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">hb</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">or</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3435em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">ρ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">hb</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">or</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">ha</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure></li></ul></li></ul><ul id="708ccb9c-9939-45b3-be76-cff66122ed5a" class="bulleted-list"><li style="list-style-type:disc"><code><strong>viscosityKernel</strong></code><strong>:</strong> This function calculates the viscous forces acting between particles, which are essential for simulating the internal friction of the fluid, allowing us to model the energy dissipation and angular momentum transfer that occur in the turbulent gas clouds of a supernova.<ul id="a7e41b85-2770-44c6-b09f-926ad5f75cc8" class="bulleted-list"><li style="list-style-type:circle">We calculate viscosity force by using a cubic spline kernel function that is commonly used in SPH simulations. <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span><span>﻿</span></span> is our smoothing radius, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span><span>﻿</span></span> is the distance between particles</li></ul><figure id="17e40734-7886-4dad-be7c-6dae0ef7072b" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>viscosityKernel</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mn>315</mn><mrow><mn>64</mn><mi>π</mi><msup><mi>h</mi><mn>9</mn></msup></mrow></mfrac><mo stretchy="false">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo>−</mo><msup><mi>r</mi><mn>2</mn></msup><msup><mo stretchy="false">)</mo><mn>3</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><mi>r</mi><mo>&lt;</mo><mi>h</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{viscosityKernel}(r,h) = \begin{cases} \frac{315}{64 \pi h^9} (h^2 - r^2)^3 &amp; \text{{if }} r &lt; h \\0 &amp; \text{{otherwise}}\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">viscosityKernel</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">64</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">315</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">if </span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">h</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord">otherwise</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure><figure id="ef16b0f4-e7b2-4138-97e8-0f40ec5b704d" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>viscosityForce</mtext><mo>=</mo><munder><mo>∑</mo><mi>j</mi></munder><mo stretchy="false">(</mo><msub><mi mathvariant="bold">v</mi><mi>j</mi></msub><mo>−</mo><msub><mi mathvariant="bold">v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>×</mo><mtext>viscosityKernel</mtext><mo stretchy="false">(</mo><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{{viscosityForce}} = \sum_{j} (\mathbf{v}_j - \mathbf{v}_i) \times \text{{viscosityKernel}}(r_{ij}, h)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord"><span class="mord">viscosityForce</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4638em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord"><span class="mord">viscosityKernel</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></span></div></figure><ul id="499090e9-1ca8-4a1e-905b-b653e49b497d" class="bulleted-list"><li style="list-style-type:circle">This approach effectively models the internal friction between particles, which is crucial for simulating fluid flow and interactions in scenarios such as gas dynamics in supernovae. The choice of the cubic spline kernel for viscosity is motivated by its smoothness and compact support, which are beneficial for numerical stability and computational efficiency in particle-based simulations.</li></ul></li></ul><p id="b090b4c0-31e1-4ccf-be9a-fa83ee6513a4" class=""><strong>2. Temperature Calculation:</strong></p><ul id="2c70eda1-5bed-4801-ad19-30a007b59ed8" class="bulleted-list"><li style="list-style-type:disc"><code><strong>computeTemperature</strong></code><strong>:</strong> This method estimates the temperature of particles based on their kinetic energy. The kinetic theory of gases relates the microscopic motions of individual particles to the macroscopic temperatures observed in a gas. By calculating the temperature as a function of kinetic energy using the Boltzmann constant, this method allows the simulation to dynamically update particle properties in response to changes in their velocities and interactions, facilitating the accurate simulation of heat transfer and thermal effects crucial for modeling the thermonuclear processes in supernovas.</li></ul><h3 id="256487a2-5296-40e6-9f69-c4ad90bb9b4c" class="">Integration into the Simulation Loop</h3><p id="ba7ad9f8-772d-404f-b95e-d02ba80756a3" class="">Within <strong><code>ParticleSolverCPUFluid.cpp</code></strong>, these methods are integrated into the particle update loop, ensuring that each particle&#x27;s behavior is governed by physically accurate, temperature-dependent properties:</p><ul id="5f9ae8e2-927e-48a7-8ea1-17cf3a276c74" class="bulleted-list"><li style="list-style-type:disc"><strong>Temperature-dependent dynamics:</strong> By integrating the temperature calculations directly into the update loop, we ensure that the physical properties of each particle, such as viscosity and pressure forces, are correctly updated based on the local thermal conditions. This integration is critical for modeling the complex interplay of thermal energy, radiation pressure, and gravity that drives the evolution of a supernova.</li></ul><ul id="8a28c8a2-9f7d-4dff-984f-e57581d140b7" class="bulleted-list"><li style="list-style-type:disc"><strong>Pressure and gravitational forces:</strong> Modifications to the pressure force computations account for the additional explosive outward forces generated by high temperatures in the supernova core. Similarly, gravitational calculations are adjusted to accurately simulate the collapse of the core and the subsequent expulsion of the outer layers. This approach allows our simulation to dynamically model both the implosion and explosion phases of a supernova, capturing the cyclical nature of compression and expansion seen in these events.</li></ul><p id="90e79311-e399-4c0a-bedc-5749479ee180" class="">By carefully implementing and integrating these advanced computational methods, we have significantly enhanced the realism and scientific accuracy of our supernova simulation. Each method has been tailored to reflect the unique conditions of supernova physics, allowing us to explore this cataclysmic event with unprecedented detail and fidelity.</p><h2 id="f974e923-69e0-418a-8515-5a7293a19d8b" class="">Shader Improvements</h2><p id="07fa3c39-2f5b-46c7-81e3-6fa02411353d" class=""><strong>Implementation</strong></p><p id="6b1aaa11-d8d2-4f0f-8296-e7969ed160bc" class="">Using knowledge from Project 4, we modified the original vertex and fragment shaders to fit our needs. The main features we added were gaseous particles and better color mapping.</p><p id="f59b4333-be98-4561-8f14-ed59552b2814" class="">For gaseous particles, this mostly involved rendering each individual particle as a blurred sphere based on particle characteristics such as mass, and distance from origin. The mass component was important since each simulation particle represents multiple gaseous particles which would make up the region around that simulation particle. The more mass, the more apparent and brighter the simulation particle should appear. The distance from the origin was used to fix a problem where particles appeared clumpy when they spread apart. The essential idea is for each pixel, we adjust the alpha based on its distance on the distance from the particle and the size of the particle (more spread-out gasses are thinner). The formula we ended up using was <code>(0.25f-abs(dist)) * 4.0f / particleSize</code>.</p><div id="3a99ac2f-89ba-4fd6-bfe9-a73dd1a2bbd9" class="column-list"><div id="5ea1a955-983b-49ee-87ac-c27d91192aad" style="width:56.25%" class="column"><figure id="9267291f-11c4-42a2-906f-097acdcc037b" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%201.png"><img style="width:384px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%201.png"/></a><figcaption>The particles don’t feel cohesive as they should be.</figcaption></figure></div><div id="0a295a55-78ba-437e-86fd-81613958c616" style="width:43.74999999999999%" class="column"><figure id="a9fd462b-c034-4aed-ba36-242a4473f88e" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%202.png"><img style="width:612px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%202.png"/></a><figcaption>When adjusting sizes of spread out particles, it resembles a gas more.</figcaption></figure></div></div><p id="090a855a-403e-42bb-9f4f-17f4d29ea7bf" class="">We then added back the original particles to make the cloud fuller and less like a random blur in the screen.</p><div id="61e6b0cf-55b1-4a6e-8e99-fc67b75bfd41" class="column-list"><div id="1512e6be-92cf-46eb-a0ad-3c27a21ebcec" style="width:50%" class="column"><figure id="a1894b1d-06b2-427a-bb11-78dbafd15bad" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/1d7b3980-0eb9-49dc-8cb8-f25388e6463f.png"><img style="width:384.52261306532665px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/1d7b3980-0eb9-49dc-8cb8-f25388e6463f.png"/></a><figcaption>Blue initial state</figcaption></figure></div><div id="9a923256-3357-499f-b57f-7b39e0c6abc4" style="width:50%" class="column"><figure id="821222c1-5073-4c63-a00b-c88364159a5c" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%203.png"><img style="width:384px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%203.png"/></a><figcaption>Yellow after explosion</figcaption></figure></div></div><p id="b6f72ccd-3a0d-469e-a429-cc561040cd5a" class="">Then, for colors, we essentially used the temperature for the hue, velocity for the value, and a constant float of <code>1.0f</code> for our saturation. This involved using the OpenGL C++ API to create a new buffer to feed in particle temperatures. We also normalized the temperatures and velocities using this formula (generalized): <code>clamp(characteristic - min_val / max_val, 0.0, 1.0)</code>. We then converted this HSV color to RGB.</p><div id="2b089e6a-7b9d-4404-9d17-86e970a2e458" class="column-list"><div id="dd9e385b-e97e-45f7-b9b2-5d29d82b9e42" style="width:50%" class="column"><figure id="09bb9e65-7443-4b12-8fca-e969d3e972e3" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/7a3e1c80-17cb-4f41-b740-bcbc3ece7ea6.png"><img style="width:384px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/7a3e1c80-17cb-4f41-b740-bcbc3ece7ea6.png"/></a><figcaption>Side view</figcaption></figure></div><div id="a20f124b-03a1-471f-854e-0d40d57da7c7" style="width:50%" class="column"><figure id="e8ed0ae3-0973-45b0-9d10-108fb2371af7" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/3bddc78f-8e13-49e4-8a49-e88010ecb079.png"><img style="width:384px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/3bddc78f-8e13-49e4-8a49-e88010ecb079.png"/></a><figcaption>Temperatures are a little inaccurate</figcaption></figure></div></div><p id="cbc79fd8-2337-4ce8-a1f4-0ce1014831e7" class=""><strong>Debugging</strong></p><p id="c59fea51-7dbf-47e7-b4d9-40b2f9b23ab8" class="">In general, debugging shaders was difficult since there was no way to tell what values were actually being calculated in the shaders, so it involved visual debugging (i.e. using the grey scale to show the alphas, tuning parameters in the render loop). One particular trick that was useful for determining the max and min temperatures was to test values based on printed-out temperatures for thresholds between temperatures (using a simple if statement for the cutoff and playing through the simulation). An ideal cut off would mean that 99% of the particles fall in the same color.</p><div id="7d30f05b-c1b6-4ad6-9ee9-d2e15b2c50b9" class="column-list"><div id="fd7567b2-6322-417a-8f11-0ad45f008edf" style="width:68.75%" class="column"><figure id="88ed6041-8271-45bf-825d-1a5261ab227b" class="image" style="text-align:left"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%204.png"><img style="width:480px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%204.png"/></a><figcaption>These images show that there was something wrong with the clipping, which was fixed by reading the OpenGL documentation to set up blending properly. They did help with tuning the alpha calculation though.</figcaption></figure><p id="753622d5-64fb-4d2f-b6eb-056303fe24b7" class="">program-structure</p></div><div id="5079a12d-fd8e-4811-8dd7-b18fb116bc6b" style="width:31.25%" class="column"><figure id="f56751b9-861a-4085-a539-e174f7745891" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%205.png"><img style="width:240px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%205.png"/></a></figure><figure id="3386f247-0eb0-42d5-b033-8625b765ff33" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%206.png"><img style="width:240px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%206.png"/></a></figure></div></div><figure id="4d7c2f31-27ca-4a07-8136-58fd20252035" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%207.png"><img style="width:384px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%207.png"/></a><figcaption>This was a pretty good cut-off, most of the particles were above the temperature threshold except for the portions in red.</figcaption></figure><h1 id="2ae5c70a-6df9-44c1-b2b5-645ea37b069c" class="">Results</h1><p id="6b10921f-7122-4363-9b33-3ea5e7ec3afd" class="">Below is a selected demo of our final simulation:</p><figure id="066c6543-3fc7-4473-812b-59b126b4aff0" class="image"><a href="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%201.gif"><img style="width:720px" src="StarDust%20What%20We%E2%80%99re%20Made%20Of%201aed9710538a43d0a0e2038550922fce/Untitled%201.gif"/></a></figure><p id="81f4bce6-c98a-4175-8e8a-f3faeca2c214" class="">All the demos: <a href="https://drive.google.com/drive/folders/1v8LN2ovgF00p0yG81St1718MG8fAi_YV?usp=drive_link">google drive</a></p><h1 id="4498ed56-48fa-433f-87d1-5ce49bbbf783" class="">Final Project Video</h1>
<iframe width="896" height="504" src="https://www.youtube.com/embed/zmooJ_RjpVo?si=c62DEdW_vnsWcBWr" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<h1 id="0094af31-a16c-48ce-b2bf-61d99bec9387" class="">Key Takeaways</h1><ol type="1" id="cfd25c3d-52f7-4fb2-9722-e6e1d07b29e9" class="numbered-list" start="1"><li><strong>Challenges in 3D Supernova Simulation</strong>:<ul id="a780d2ae-8416-42e4-98ca-249257b0af58" class="bulleted-list"><li style="list-style-type:disc">Simulating a supernova explosion in three dimensions presented significant challenges due to the complex interplay of gravitational forces, fluid dynamics, and thermodynamic properties like temperature, velocity, and pressure. We encountered difficulties in realistically modeling these forces simultaneously, which required a deep dive into astrophysical principles and iterative refinement of our simulation parameters.</li></ul></li></ol><ol type="1" id="46e371f0-2317-4cf5-bf49-96a02bae4f4e" class="numbered-list" start="2"><li><strong>Learning from Fluid Mechanics Integration</strong>:<ul id="a65b5aa1-d929-4983-bdfa-a2a99e5ce4d6" class="bulleted-list"><li style="list-style-type:disc">Integrating fluid mechanics into our particle simulation framework was both challenging and enlightening. The process highlighted the critical role of fluid dynamics in simulating the behavior of gaseous elements within a star. We learned to adapt fluid dynamics theories to the discrete nature of particle systems, enhancing our understanding of how gases behave under extreme conditions like those found in supernovas.</li></ul></li></ol><ol type="1" id="2fd4122e-d8e5-42fd-9fe9-d6d94f7e0846" class="numbered-list" start="3"><li><strong>Complexities of Temperature Computation and Visualization</strong>:<ul id="ae5ac87c-ba98-41ec-8282-2fd493755bb2" class="bulleted-list"><li style="list-style-type:disc">Calculating and visualizing temperature within the simulation proved to be one of the most complex aspects of our project. We struggled with the accurate computation of temperature gradients and the dynamic updating of shader parameters to visually represent these changes. This challenge emphasized the necessity for robust computational algorithms and underscored the intricate relationship between physical properties and their visual representation.</li></ul></li></ol><ol type="1" id="e8d0caa5-e639-4a05-8153-fbad5efb4c29" class="numbered-list" start="4"><li><strong>Selecting and Implementing Appropriate Physics Equations</strong>:<ul id="1150a241-e9d2-437b-8b5b-d40b852263ba" class="bulleted-list"><li style="list-style-type:disc">Choosing the right physics equations to model the detailed stages of a supernova required extensive research and practical testing. We learned the importance of selecting equations that not only reflect true astrophysical phenomena but also integrate seamlessly into our computational framework, balancing accuracy with computational feasibility.</li></ul></li></ol><ol type="1" id="c5ed0979-b191-48a8-a151-d68da4b63a62" class="numbered-list" start="5"><li><strong>Lack of References</strong>:<ul id="fbb029cc-4790-4ef2-aced-5d79c33406b0" class="bulleted-list"><li style="list-style-type:disc">As mentioned before, a supernova explosion is much more complex than what we initially thought. Papers detailing how the astrophysics of a supernova explosion worked involved numerous complex equations where the correct ones to use vary tremendously across different stages of the explosion. Most of the simulations that are available are rendered on much more capable machines like supercomputers which achieve computational speeds far beyond what we have available. As a result, we could only create a simplified version of the explosion based on the research that we have done into those papers based on our own understanding.</li></ul></li></ol><h1 id="3fd45704-7739-4c56-82fa-3005818e27d0" class="">Member Contributions</h1><p id="4621ac55-1276-4ee4-91c8-5a6bebab0e34" class=""><strong>Manan Bhargava (</strong><strong><a href="mailto:manan.bhargava@berkeley.edu">manan.bhargava@berkeley.edu</a></strong><strong>)</strong></p><ul id="18479f44-59f5-4c03-8d8a-2932bce8f38b" class="bulleted-list"><li style="list-style-type:disc">Ideation, brainstorming, physics equations development</li></ul><ul id="e1ebaf41-fa9e-46ae-b248-ae279824a661" class="bulleted-list"><li style="list-style-type:disc">Organizing documentation, compiling research</li></ul><ul id="49bd446d-446a-40de-b9bd-e8d90afe8b8f" class="bulleted-list"><li style="list-style-type:disc">Adding some logic into the codebase for the temperature </li></ul><ul id="e841baf7-bdbd-4057-911d-fa2662752e94" class="bulleted-list"><li style="list-style-type:disc">Report creation</li></ul><p id="10a0154a-e4e5-407d-8360-7a07185e26f5" class="">
</p><p id="131da08d-dc82-4ba3-a978-a91fe9f02424" class=""><strong>Snehaa Ganesh Kumar (</strong><a href="mailto:snehaa@berkeley.edu"><strong>snehaa@berkeley.edu</strong></a><strong>)</strong></p><ul id="b2cd7a58-2daa-4c49-a8e7-b58bb0917f7e" class="bulleted-list"><li style="list-style-type:disc">Shock Wave Dynamics</li></ul><ul id="00fc9b77-4ddd-4145-9257-e5c1e3f9c1a3" class="bulleted-list"><li style="list-style-type:disc">Pressure &amp; Gravity Modifications for Core-Collapse, Explosion Multiplier</li></ul><ul id="46cd3423-47d5-412e-8131-eb36bc1e6740" class="bulleted-list"><li style="list-style-type:disc">Report creation</li></ul><ul id="2931da98-f85a-421a-9f0f-817b69c8b918" class="bulleted-list"><li style="list-style-type:disc">Help Out With Report + Brainstorming</li></ul><p id="cd2656ba-b009-4682-afb9-1f40bf61fabe" class="">
</p><p id="d6014ece-8188-4ca0-b102-298198e41941" class=""><strong>Nak Vong (</strong><strong><a href="mailto:kiriratanakvong@berkeley.edu">kiriratanakvong@berkeley.edu</a></strong><strong>)</strong></p><ul id="64cbc210-81e5-4e60-8be5-8986506a8908" class="bulleted-list"><li style="list-style-type:disc">Added Density, Temperature, and Viscosity for particles in the particle system</li></ul><ul id="bc2fe8f8-650f-451d-960a-832a7bc76840" class="bulleted-list"><li style="list-style-type:disc">Added Pressure Force exerted on each particle from neighboring particles</li></ul><ul id="d7803473-1cec-4ac0-8f01-78762ba5f450" class="bulleted-list"><li style="list-style-type:disc">Help Out With Report + Brainstorming</li></ul><p id="faff9168-154e-4ea6-bbf5-8d62749617ef" class="">
</p><p id="183afd4f-fbb1-4721-8996-6a4df3aa6c97" class=""><strong>Brandon Wong (</strong><strong><a href="mailto:bwong928@berkeley.edu">bwong928@berkeley.edu</a></strong><strong>)</strong></p><ul id="f7285554-c0ca-4437-92c1-5dff72a88a7a" class="bulleted-list"><li style="list-style-type:disc">Coding Shaders, Temperature Map, and Gaseous Particles</li></ul><ul id="accca757-a5e9-4cb4-a2f4-3fdb365b270f" class="bulleted-list"><li style="list-style-type:disc">Coding Miscellaneous Infrastructure and Boilerplate</li></ul><ul id="11bbe24b-e5b9-4a03-bf62-0e399d445a24" class="bulleted-list"><li style="list-style-type:disc">Help Out With Report + Brainstorming</li></ul><h1 id="963dbdaf-2dbd-4935-8b5e-b5188bb2ace7" class="">References</h1><ol type="1" id="c19e25e1-b5b9-439d-aba8-1d4f312384c5" class="numbered-list" start="1"><li>Murphy, Jeremiah W., and Adam Burrows. &quot;An Analytic Model of the Ray-by-Ray Approximation for Rotating Core Collapse.&quot; Accepted for publication in ApJ. arXiv preprint arXiv:0805.3345 (2008).</li></ol><ol type="1" id="af3abc0c-e092-4682-8f83-8a1d950566fe" class="numbered-list" start="2"><li>Bethe, Hans A. &quot;Supernova Mechanisms.&quot; Reviews of Modern Physics 62, no. 4 (1990): 801.</li></ol><ol type="1" id="6f9d8fb8-91f3-4b48-b90d-ccc5cac8f828" class="numbered-list" start="3"><li>Koschier, Dan, Jan Bender, Barbara Solenthaler, and Matthias Teschner. &quot;<a href="https://sph-tutorial.physics-simulation.org/pdf/SPH_Tutorial.pdf">Smoothed Particle Hydrodynamics Techniques for the Physics Based Simulation of Fluids and Solids</a>.&quot; arXiv preprint arXiv:2010.11254 (2020).</li></ol><ol type="1" id="4d45ddb2-2bdb-44b8-b81e-b3899fee0a9a" class="numbered-list" start="4"><li>Pan, Kuo-Chuan, Matthias Liebendörfer, Matthias Hempel, and Friedrich-Karl Thielemann. &quot;<a href="https://arxiv.org/pdf/2010.11254">Two-Dimensional Core-Collapse Supernova Simulations with the Isotropic Diffusion Source Approximation for Neutrino Transport</a>.&quot; Accepted for publication in ApJ. arXiv preprint arXiv:1505.02513 (2015).</li></ol><ol type="1" id="9a7aaa3e-aa5a-43e2-86b0-bcdf106ce10e" class="numbered-list" start="5"><li>Vivas, Marc. &quot;N-body Simulation GitHub Repository.&quot; Accessed April 30, 2024. <a href="https://github.com/MarcVivas/N-body/tree/main">https://github.com/MarcVivas/N-body/tree/main</a>.</li></ol><p id="468b3d93-460e-4e6b-a4c7-214030ac3256" class="">
</p><p id="046c4a37-ab13-4b7e-bbe1-726d1688dec9" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>